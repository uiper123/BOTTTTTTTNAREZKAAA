# Telegram Bot для нарезки видео на шотсы

Бот автоматически нарезает видео на короткие клипы (шотсы) с добавлением заголовков, субтитров и эффектов.

## Возможности

- ✅ Обработка видео файлов и YouTube ссылок
- ✅ Нарезка на клипы заданной длительности (по умолчанию 30 сек)
- ✅ Создание размытого фона на весь экран
- ✅ Размещение основного видео по центру
- ✅ Добавление красных заголовков (заголовок и подзаголовок)
- ✅ Генерация субтитров через Whisper
- ✅ Анимированные субтитры с эффектом подпрыгивания
- ✅ Разбивка больших видео на чанки по 5 минут
- ✅ Загрузка результатов на Google Drive
- ✅ Создание файла со ссылками на скачивание

## Установка

### 1. Установите зависимости

```bash
pip install -r requirements.txt
```

### 2. Установите FFmpeg

**Windows:**
- Скачайте FFmpeg с https://ffmpeg.org/download.html
- Добавьте путь к ffmpeg.exe в PATH

**Linux/Mac:**
```bash
# Ubuntu/Debian
sudo apt update && sudo apt install ffmpeg

# macOS
brew install ffmpeg
```

### 3. Настройте переменные окружения

Файл `.env` уже содержит необходимые токены:
- `TELEGRAM_BOT_TOKEN` - токен вашего Telegram бота
- `GOOGLE_OAUTH_TOKEN_BASE64` - токен для Google Drive API

### 4. (Опционально) Добавьте cookies для YouTube

Если нужно скачивать приватные видео с YouTube, создайте файл `cookies.txt` с cookies из браузера.

## Запуск

```bash
python run_bot.py
```

## Использование

### Команды бота:

- `/start` - начать работу с ботом
- `/duration <секунды>` - установить длительность клипов (по умолчанию 30)
- `/title <текст>` - установить заголовок
- `/subtitle <текст>` - установить подзаголовок

### Отправка видео:

1. Отправьте боту видео файл или ссылку на YouTube
2. Бот автоматически обработает видео:
   - Разобьет на чанки (если больше 5 минут)
   - Сгенерирует субтитры
   - Создаст клипы с эффектами
   - Загрузит на Google Drive
3. Получите ссылку на файл со всеми ссылками для скачивания

### Формат выходного видео:

- Размер: 1080x1920 (вертикальный для шотсов)
- Фон: размытая версия основного видео
- Основное видео: по центру, может быть обрезано
- Заголовки: красного цвета, вверху экрана
- Субтитры: белые с черной обводкой, анимация подпрыгивания

## Структура проекта

```
├── bot.py                    # Основной файл Telegram бота
├── video_processor.py        # Обработка видео и координация
├── video_editor.py          # Создание эффектов и монтаж
├── google_drive_uploader.py # Загрузка на Google Drive
├── run_bot.py              # Скрипт запуска
├── requirements.txt        # Зависимости Python
├── .env                   # Переменные окружения
├── Obelix Pro.ttf        # Шрифт для заголовков
└── README.md             # Документация
```

## Примечания

- Whisper будет автоматически скачан при первом запуске
- Временные файлы автоматически удаляются после обработки
- Большие видео разбиваются на чанки для экономии памяти
- Все результаты загружаются на Google Drive с публичным доступом

## Устранение неполадок

### Ошибка FFmpeg
Убедитесь, что FFmpeg установлен и доступен в PATH:
```bash
ffmpeg -version
```

### Ошибка Google Drive API
Проверьте правильность токена в переменной `GOOGLE_OAUTH_TOKEN_BASE64`

### Ошибка Telegram API
Проверьте токен бота в переменной `TELEGRAM_BOT_TOKEN`